# Juniper propriatery BGP4-V2-MIB-JUNIPER normalized to the OpenCOnfig-like structure
# 

---

extends:
  #- system-mib.yml
  #- if-mib.yml
  - bgp-global.yml

metrics:


# BGP neighbors

  - MIB: /protocols   # openconfig-bgp
    table:
      OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1    # BGP4-V2-MIB-JUNIPER::jnxBgpM2PeerTable
      name: bgp/neighbors # /protocols/bgp/neighbors
      # oc-path: /network-instances/network-instance/protocols/protocol/bgp/neighbors/neighbor/state

    symbols:

      - tag: bgp:session-state
        OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.2
        name: jnxBgpM2PeerState
        enum:
          idle: 1
          connect: 2
          active: 3
          opensent: 4
          openconfirm: 5
          established: 6

      - tag: bgp:enabled
        OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.3
        name: jnxBgpM2PeerStatus
        
      - tag: bgp:in-updates
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.1.1.1
        name: jnxBgpM2PeerInUpdates
        
      - tag: bgp:out-updates
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.1.1.2
        name: jnxBgpM2PeerOutUpdates
        
      - tag: bgp:in-messages
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.1.1.3
        name: jnxBgpM2PeerInTotalMessages
        
      - tag: bgp:out-messages
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.1.1.4
        name: jnxBgpM2PeerOutTotalMessages
        
      - tag: bgp:established-transitions
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.1.1.5
        name: jnxBgpM2PeerFsmEstablishedTrans

      - tag: bgp:last-established
        OID: .1.3.6.1.4.1.2636.5.1.1.2.4.1.1.1
        name: jnxBgpM2PeerFsmEstablishedTime


    metric_tags:

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.1
          name: jnxBgpM2PeerIdentifier
        tag: bgp:neighbor-address

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.6
          name: jnxBgpM2PeerLocalAddrType
          enum:
            ipv4: 1
            ipv6: 2
        tag: bgp:local-address-type

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.7
          name: jnxBgpM2PeerLocalAddr
          conversion: hextoip
        tag: bgp:local-address

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.8
          name: jnxBgpM2PeerLocalPort
        tag: bgp:local-port

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.9
          name: jnxBgpM2PeerLocalAs
        tag: bgp:local-as

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.10
          name: jnxBgpM2PeerRemoteAddrType
          enum:
            ipv4: 1
            ipv6: 2
        tag: bgp:remote-address-type

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.11
          name: jnxBgpM2PeerRemoteAddr
          conversion: hextoip
        tag: bgp:remote-address

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.12
          name: jnxBgpM2PeerRemotePort
        tag: bgp:remote-port

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.13
          name: jnxBgpM2PeerRemoteAs
        tag: bgp:peer-as

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.14
          name: jnxBgpM2PeerIndex
        tag: bgp:peer-index

      - column:
          OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1.1.15
          name: jnxBgpM2PeerRoutingInstance
        tag: bgp:network-instance



  - MIB: /protocols
    table:
      OID: .1.3.6.1.4.1.2636.5.1.1.2.1.1    # BGP4-V2-MIB-JUNIPER::jnxBgpM2PrefixCountersTable
      name: bgp/neighbors/prefixes # /protocols/bgp/neighbors/prefixes

    symbols:

      - tag: bgp:received-pre-policy    # in-prefixes
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.2.1.7
        name: jnxBgpM2PrefixInPrefixes
        
      - tag: bgp:received     # in-prefixes-accepted
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.2.1.8
        name: jnxBgpM2PrefixInPrefixesAccepted
        
      - tag: bgp:rejected    # in-prefixes-rejected
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.2.1.9
        name: jnxBgpM2PrefixInPrefixesRejected
        
      - tag: bgp:sent    # out-prefixes
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.2.1.10
        name: jnxBgpM2PrefixOutPrefixes
        
      - tag: bgp:installed    # in-prefixes-active
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.2.1.11
        name: jnxBgpM2PrefixInPreixesActive
        

    metric_tags:

    - tag: bgp:afi
      column:
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.2.1.1
        name: jnxBgpM2PrefixCountersAfi
        enum:
          unknown: 0
          ipv4: 1
          ipv6: 2
          ipv4z: 3
          ipv6z: 4
          dns: 16
          vpn: 25

    - tag: bgp:safi
      column:
        OID: .1.3.6.1.4.1.2636.5.1.1.2.6.2.1.2
        name: jnxBgpM2PrefixCountersSafi
        enum:
          unicast: 1
          multicast: 2
          labeled-unicast: 4
          vpn: 128
          mcast-vpn: 129
          flowspec: 133
          ms-pw: 6
          l2vpn: 65
          evpn: 70