# http://oid-info.com/get/1.3.6.1.4.1.2636.3.1.13.1

# sysDescr examples from Juniper devices:
# 
# Juniper Networks, Inc. qfx5100-48s-6q Ethernet Switch, kernel JUNOS 14.1X53-D40.8, Build date: 2016-11-09 02:17:36 UTC Copyright (c) 1996-2016 Juniper Networks, Inc.
# Juniper Networks, Inc. JNP204 [MX204] internet router, kernel JUNOS 17.4R2.4, Build date: 2018-08-17 02:23:20 UTC Copyright (c) 1996-2018 Juniper Networks, Inc.
# Juniper Networks, Inc. mx104 internet router, kernel JUNOS 13.3R9.13, Build date: 2016-03-01 09:06:52 UTC Copyright (c) 1996-2016 Juniper Networks, Inc.
# Juniper Networks, Inc. mx80-48t internet router, kernel JUNOS 13.3R9.13, Build date: 2016-03-01 09:06:52 UTC Copyright (c) 1996-2016 Juniper Networks, Inc.
# Juniper Networks, Inc. qfx5100-24q-2p Ethernet Switch, kernel JUNOS 14.1X53-D35.3, Build date: 2016-02-29 23:39:06 UTC Copyright (c) 1996-2016 Juniper Networks, Inc.


# lldpLocSysDesc examples:
# Juniper MX104 Internet Backbone Router
# Juniper Virtual Chassis Switch
# Juniper Networks, Inc. qfx5100-48s-6q Ethernet Switch, kernel JUNOS 14.1X53-D40.8, Build date: 2016-11-09 02:17:36 UTC Copyright (c) 1996-2016 Juniper Networks, Inc.
# Juniper Networks, Inc. mx80-48t , version 13.3R9.13 Build date: 2016-03-01 08:36:50 UTC 
# Juniper Networks, Inc. JNP204 [MX204] internet router, kernel JUNOS 17.4R2.4, Build date: 2018-08-17 02:23:20 UTC Copyright (c) 1996-2018 Juniper Networks, Inc.


---
extends:
  #- system-mib.yml
  - if-mib.yml
  - ip-mib.yml
  - bgp4-mib.yml
  - ospf-mib.yml
  - host-resources-mib.yml
  - entity-mib.yml

sysobjectid:
  - 1.3.6.1.4.1.2636.1.1.1.*


# metrics:
#   - MIB: HOST-RESOURCES-MIB
#     symbols:
#       - OID: 1.3.6.1.2.1.25.1.1.0
#         name: hrSystemUptime
#       - OID: 1.3.6.1.2.1.25.1.5.0
#         name: hrSystemNumUsers
#       - OID: 1.3.6.1.2.1.25.1.6.0
#         name: hrSystemProcesses
#       - OID: 1.3.6.1.2.1.25.1.7.0
#         name: hrSystemMaxProcesses

metric_tags:
  # Tags from SYSTEM-MIB which we need to parse in the Juniper specific way
  - column:
      OID: 1.3.6.1.2.1.1.5.0
      name: sysName
  - column:
      OID: 1.3.6.1.2.1.1.6.0
      name: sysLocation
  - column:
      OID: 1.3.6.1.2.1.1.2.0
      name: sysObjectID
      allow_duplicate: true
  - column:
      OID: 1.3.6.1.6.3.10.2.1.1.0
      name: snmp-engine-id
  - column:
      OID: 1.3.6.1.2.1.1.1.0
      name: sysDescr_parsing
      conversion: "regexp:(?P<sysDescr>(?P<vendor>Juniper Networks), Inc\\. (?P<model>\\S+).*kernel (?P<os_name>\\S+).*\\s(?P<os_version>[\\w\\-]+\\.[\\w\\-]+\\.[\\w\\-]+).*)"
      #conversion: "regexp:(?P<os_name>JUNOS)"

  # Vendor specific OIDS
  - column:
      OID: 1.3.6.1.4.1.2636.3.1.3.0
      name: serial_number
  - column:
      OID: 1.3.6.1.4.1.2636.3.1.2.0
      name: product_name

metrics:

  # Uptime
  - MIB: device_normalized
    symbol: 
      OID: 1.3.6.1.6.3.10.2.1.3.0
      name: uptime_sec
  - MIB: device_normalized
    symbol:
      OID: 1.3.6.1.2.1.1.3.0
      name: uptime

  # device_normalized
  - MIB: device_normalized
    symbol:
      OID: 1.3.6.1.4.1.2636.3.1.13.1.7.9.1.0.0
      name: temperature
  - MIB: device_normalized
    symbol:
      OID: 1.3.6.1.4.1.2636.3.1.13.1.8.9.1.0.0
      name: cpu_util
  - MIB: device_normalized
    symbol:
      OID: 1.3.6.1.4.1.2636.3.1.13.1.11.9.1.0.0
      name: memory_util

  # - column:
  #     OID: .1.0.8802.1.1.2.1.3.4.0
  #     name: lldpLocSysDesc
  #     #conversion: "regexp: ([\\w\\-]+\\.[\\w\\-]+\\.[\\w\\-]+)"
  #     conversion: "regexp:(?P<os_name>JUNOS)?\\s+(?P<os_version>[\\w\\-]+\\.[\\w\\-]+\\.[\\w\\-]+)"
  #     allow_duplicate: true
#  - column:
#      OID: 1.3.6.1.2.1.1.1.0
#      name: sysDescr
#      allow_duplicate: true
#      conversion: "regexp:kernel\\s+(?P<os_name>\\S+?)\\s+(?P<os_version>\\S+)"
  # - column:
  #     OID: .1.0.8802.1.1.2.1.3.4.0
  #     name: os_name
  #     conversion: "regexp: kernel\\s+(\\w+)\\s+[\\w\\.\\-]+,"
  #     allow_duplicate: true



  - MIB: JUNIPER-MIB
    table:
      OID: 1.3.6.1.4.1.2636.3.1.13.1
      name: jnxOperatingEntry
    symbols:
      - OID: 1.3.6.1.4.1.2636.3.1.13.1.6
        name: jnxOperatingState
        poll_time_sec: 60
        tag: state
        enum:
          unknown: 1
          running: 2
          ready: 3
          reset: 4
          runningAtFullSpeed: 5
          down: 6
          standby: 7
      - OID: 1.3.6.1.4.1.2636.3.1.13.1.7
        name: jnxOperatingTemp
        poll_time_sec: 60
        tag: temperature
      - OID: 1.3.6.1.4.1.2636.3.1.13.1.8
        name: jnxOperatingCPU
        poll_time_sec: 60
        tag: CPU
      - OID: 1.3.6.1.4.1.2636.3.1.13.1.11
        name: jnxOperatingBuffer
        poll_time_sec: 60
        tag: MemoryUtilization
      - OID: 1.3.6.1.4.1.2636.3.1.13.1.26
        name: jnxOperatingFRUPower
        poll_time_sec: 60
        tag: Power
        unit: V
    metric_tags:
      - tag: chassis
        column:
          OID: 1.3.6.1.4.1.2636.3.1.13.1.18
          name: jnxOperatingChassisDescr
      - tag: component_description
        column:
          OID: 1.3.6.1.4.1.2636.3.1.13.1.5
          name: jnxOperatingDescr