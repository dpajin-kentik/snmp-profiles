# Profile is intended to be used in an extends block
# http://oid-info.com/get/1.3.6.1.2.1.4.31
---
metrics:

# THis is a table to collect IPv4 addresses info as a metadata
# According to the openconfig model this would be path: /interfaces/interface/subinterfaces/subinterface/ipv4/addresses/address/state
# Shorter it can be: /interfaces/subinterfaces/ipv4/addresses

            #print(n)
            # mask_list = n.netmask.split(".")
            # prefix = 0
            # for octet in mask_list:
            #   prefix = prefix + str(bin(int(octet))).count("1")
            # n.prefix = prefix
            # return None


# - MIB: openconfig-interfaces
#   table:
#     OID: .1.3.6.1.2.1.4.20
#     name: interfaces/subinterfaces/ipv4/addresses
#   symbols:
#     - tag: ip-max-size
#       OID: .1.3.6.1.2.1.4.20.1.5
#       name: ipAdEntReasmMaxSize
#   metric_tags:
#     - tag: ip
#       column:
#         OID: .1.3.6.1.2.1.4.20.1.1
#         name: ipAdEntAddr
#     - tag: ifindex
#       column:
#         OID: .1.3.6.1.2.1.4.20.1.2
#         name: ipAdEntIfIndex
#     - tag: netmask
#       column:
#         OID: .1.3.6.1.2.1.4.20.1.3
#         name: ipAdEntNetMask
#     - tag: prefix-length
#       column:
#         OID: 1.3.6.1.2.1.4.20.1.3
#         name: ipAdEntNetMask_2
#         script: |
#           def main(n):
#             if n.netmask not in "":
#               bits = dict([("0", 0), ("128", 1), ("192", 2), ("224", 3), ("240", 4), ("248", 5), ("252", 6), ("254", 7), ("255", 8)])
#               mask_list = n.netmask.split(".")
#               prefix = 0
#               for octet in mask_list:
#                 prefix = prefix + bits[octet]
#               print("prefix=" + str(prefix))
#               n.prefix = prefix
#               return None
#             else:
#               print("netmask is empty")
#               print(n)
#               return None




# - MIB: openconfig-interfaces2
#   table:
#     OID: 1.3.6.1.2.1.55.1.8
#     name: interfaces/subinterfaces/ipv6/addresses
#   symbols:
#     - tag: status
#       OID: 1.3.6.1.2.1.55.1.8.1.5
#       name: ipv6AddrStatus
#   metric_tags:
#     #- column:
#     #    OID: .1.3.6.1.2.1.55.1.8.1.1
#     #    name: ipv6AddrAddress
#     #  tag: ipv6_address
#     - tag: type
#       column:
#         OID: .1.3.6.1.2.1.55.1.8.1.3
#         name: ipv6AddrType
#         enum:
#           stateless: 1
#           stateful: 2
#           unknown: 3
#     - tag: status
#       column:
#         OID: .1.3.6.1.2.1.55.1.8.1.5
#         name: ipv6AddrStatus
#         enum:
#           preferred: 1
#           deprecated: 2
#           invalid: 3
#           inaccessible: 4
#           unknown: 5 
    
#     # - tag: origin
    
#     - tag: prefix-length
#       column:
#         OID: .1.3.6.1.2.1.55.1.8.1.2
#         name: ipv6AddrPfxLength
#         script: |
#           def main(n):

#             def index_to_ipv6_address(index_str):
#               ipv6_address = ""
#               for i, value in enumerate(index_str.split(".")):
#                   if i > 0 and i % 2 == 0:    
#                       ipv6_address += ":"
#                   v = int(value)
#                   if v < 15:
#                       ipv6_address += "0%x" % (v)
#                   else:
#                       ipv6_address += "%x" % (v)
#               return ipv6_address
          
#             if n.status not in "":
#               print("ipv6 metadata")
#               print(n.Index)
#               print(n)
#               index_list = n.Index.split(".", 1)
#               print(index_list)
#               n.ifindex = index_list[0]
#               print("ifindex=" + index_list[0])
#               ip = index_to_ipv6_address(index_list[1])
#               print("ip=" + ip)
#               n.ip = ip
#               return None
#             return None



- MIB: IP-MIB
  table:
    OID: 1.3.6.1.2.1.4.31.1
    name: ipSystemStatsTable
  symbols:
    - OID: 1.3.6.1.2.1.4.31.1.1.4
      name: ipSystemStatsHCInReceives
    - OID: 1.3.6.1.2.1.4.31.1.1.6
      name: ipSystemStatsHCInOctets
    - OID: 1.3.6.1.2.1.4.31.1.1.7
      name: ipSystemStatsInHdrErrors
    - OID: 1.3.6.1.2.1.4.31.1.1.8
      name: ipSystemStatsInNoRoutes
    - OID: 1.3.6.1.2.1.4.31.1.1.9
      name: ipSystemStatsInAddrErrors
    - OID: 1.3.6.1.2.1.4.31.1.1.10
      name: ipSystemStatsInUnknownProtos
    - OID: 1.3.6.1.2.1.4.31.1.1.11
      name: ipSystemStatsInTruncatedPkts
    - OID: 1.3.6.1.2.1.4.31.1.1.13
      name: ipSystemStatsHCInForwDatagrams
    - OID: 1.3.6.1.2.1.4.31.1.1.14
      name: ipSystemStatsReasmReqds
    - OID: 1.3.6.1.2.1.4.31.1.1.15
      name: ipSystemStatsReasmOKs
    - OID: 1.3.6.1.2.1.4.31.1.1.16
      name: ipSystemStatsReasmFails
    - OID: 1.3.6.1.2.1.4.31.1.1.17
      name: ipSystemStatsInDiscards
    - OID: 1.3.6.1.2.1.4.31.1.1.19
      name: ipSystemStatsHCInDelivers
    - OID: 1.3.6.1.2.1.4.31.1.1.21
      name: ipSystemStatsHCOutRequests
    - OID: 1.3.6.1.2.1.4.31.1.1.22
      name: ipSystemStatsOutNoRoutes
    - OID: 1.3.6.1.2.1.4.31.1.1.24
      name: ipSystemStatsHCOutForwDatagrams
    - OID: 1.3.6.1.2.1.4.31.1.1.25
      name: ipSystemStatsOutDiscards
    - OID: 1.3.6.1.2.1.4.31.1.1.26
      name: ipSystemStatsOutFragReqds
    - OID: 1.3.6.1.2.1.4.31.1.1.27
      name: ipSystemStatsOutFragOKs
    - OID: 1.3.6.1.2.1.4.31.1.1.28
      name: ipSystemStatsOutFragFails
    - OID: 1.3.6.1.2.1.4.31.1.1.29
      name: ipSystemStatsOutFragCreates
    - OID: 1.3.6.1.2.1.4.31.1.1.31
      name: ipSystemStatsHCOutTransmits
    - OID: 1.3.6.1.2.1.4.31.1.1.33
      name: ipSystemStatsHCOutOctets
    - OID: 1.3.6.1.2.1.4.31.1.1.35
      name: ipSystemStatsHCInMcastPkts
    - OID: 1.3.6.1.2.1.4.31.1.1.37
      name: ipSystemStatsHCInMcastOctets
    - OID: 1.3.6.1.2.1.4.31.1.1.39
      name: ipSystemStatsHCOutMcastPkts
    - OID: 1.3.6.1.2.1.4.31.1.1.41
      name: ipSystemStatsHCOutMcastOctets
    - OID: 1.3.6.1.2.1.4.31.1.1.43
      name: ipSystemStatsHCInBcastPkts
    - OID: 1.3.6.1.2.1.4.31.1.1.45
      name: ipSystemStatsHCOutBcastPkts
  metric_tags:
    - tag: ip_version
      column:
        OID: 1.3.6.1.2.1.4.31.1.1.1
        name: ipSystemStatsIPVersion
        enum:
          unknown: 0
          ipv4: 1
          ipv6: 2
          ipv4z: 3
          ipv6z: 4
          dns: 16
- MIB: IP-MIB
  table:
    OID: 1.3.6.1.2.1.4.31.3
    name: ipIfStatsTable
  symbols:
    - OID: 1.3.6.1.2.1.4.31.3.1.6
      name: ipIfStatsHCInOctets
    - OID: 1.3.6.1.2.1.4.31.3.1.7
      name: ipIfStatsInHdrErrors
    - OID: 1.3.6.1.2.1.4.31.3.1.8
      name: ipIfStatsInNoRoutes
    - OID: 1.3.6.1.2.1.4.31.3.1.9
      name: ipIfStatsInAddrErrors
    - OID: 1.3.6.1.2.1.4.31.3.1.10
      name: ipIfStatsInUnknownProtos
    - OID: 1.3.6.1.2.1.4.31.3.1.11
      name: ipIfStatsInTruncatedPkts
    - OID: 1.3.6.1.2.1.4.31.3.1.13
      name: ipIfStatsHCInForwDatagrams
    - OID: 1.3.6.1.2.1.4.31.3.1.14
      name: ipIfStatsReasmReqds
    - OID: 1.3.6.1.2.1.4.31.3.1.15
      name: ipIfStatsReasmOKs
    - OID: 1.3.6.1.2.1.4.31.3.1.16
      name: ipIfStatsReasmFails
    - OID: 1.3.6.1.2.1.4.31.3.1.17
      name: ipIfStatsInDiscards
    - OID: 1.3.6.1.2.1.4.31.3.1.19
      name: ipIfStatsHCInDelivers
    - OID: 1.3.6.1.2.1.4.31.3.1.21
      name: ipIfStatsHCOutRequests
    - OID: 1.3.6.1.2.1.4.31.3.1.24
      name: ipIfStatsHCOutForwDatagrams
    - OID: 1.3.6.1.2.1.4.31.3.1.25
      name: ipIfStatsOutDiscards
    - OID: 1.3.6.1.2.1.4.31.3.1.26
      name: ipIfStatsOutFragReqds
    - OID: 1.3.6.1.2.1.4.31.3.1.27
      name: ipIfStatsOutFragOKs
    - OID: 1.3.6.1.2.1.4.31.3.1.28
      name: ipIfStatsOutFragFails
    - OID: 1.3.6.1.2.1.4.31.3.1.29
      name: ipIfStatsOutFragCreates
    - OID: 1.3.6.1.2.1.4.31.3.1.31
      name: ipIfStatsHCOutTransmits
    - OID: 1.3.6.1.2.1.4.31.3.1.33
      name: ipIfStatsHCOutOctets
    - OID: 1.3.6.1.2.1.4.31.3.1.35
      name: ipIfStatsHCInMcastPkts
    - OID: 1.3.6.1.2.1.4.31.3.1.37
      name: ipIfStatsHCInMcastOctets
    - OID: 1.3.6.1.2.1.4.31.3.1.39
      name: ipIfStatsHCOutMcastPkts
    - OID: 1.3.6.1.2.1.4.31.3.1.41
      name: ipIfStatsHCOutMcastOctets
    - OID: 1.3.6.1.2.1.4.31.3.1.43
      name: ipIfStatsHCInBcastPkts
    - OID: 1.3.6.1.2.1.4.31.3.1.45
      name: ipIfStatsHCOutBcastPkts
  metric_tags:
    - tag: interface_name
      column:
        name: ifName
        OID: 1.3.6.1.2.1.31.1.1.1.1
