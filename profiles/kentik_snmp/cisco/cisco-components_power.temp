# Example output:
# $ grep -R components, influx | grep Container | grep power
# components,components:description=Container\ of\ Container\ of\ Power\ Supply,components:name=Container\ of\ Container\ of\ Power\ Supply,components:parent=1,components:parent-position=5,components:removable=false,components:type=container,device_ip=198.186.190.9,device_name=cat6509,index=9,power-supply/redundancy-mode=nonRedundant,power-supply/units=centiAmpsAt42v,tags.dc=iad1,tags.kentik.model=Catalyst\ WSC6503,tags.kentik.vendor=Cisco,tags.type=spine components:fru=2i,power-supply/output-current=2189i,power-supply/input-current=1701i 1669028044

# This profile will add metrics and metadata on top of already existing
# which are defined in the components.yml
# for those components which return values from additoonal table with the same index


---
extends:
  - components.yml


metrics:

  - MIB: /
    table:
      OID: 1.3.6.1.4.1.9.9.117.1.1.2    # CISCO-ENTITY-FRU-CONTROL-MIB::cefcFRUPowerStatusTable
      name: components

    symbols:

      - tag: components:oper-status
        OID: 1.3.6.1.4.1.9.9.117.1.1.2.1.2
        name: cefcFRUPowerOperStatus
        enum:
          offEnvOther: 1
          "on": 2
          offAdmin: 3
          offDenied: 4
          offEnvPower: 5
          offEnvTemp: 6
          offEnvFan: 7
          failed: 8
          onButFanFail: 9
          offCooling: 10
          offConnectorRating: 11
          onButInlinePowerFail: 12

      - tag: power-supply/input-current
        OID: 1.3.6.1.4.1.9.9.117.1.1.1.1.4
        name: cefcTotalDrawnCurrent

    metric_tags:

      # - tag: components:name
      #   column:
      #     OID: 1.3.6.1.2.1.47.1.1.1.1.7
      #     name: entPhysicalName

      # - tag: components:description
      #   column:
      #     OID: 1.3.6.1.2.1.47.1.1.1.1.2
      #     name: entPhysicalDescr

      - tag: power-supply/units
        column:
          OID: 1.3.6.1.4.1.9.9.117.1.1.1.1.2
          name: cefcPowerUnits

      - tag: power-supply/redundancy-mode
        column:
          OID: 1.3.6.1.4.1.9.9.117.1.1.1.1.5
          name: cefcPowerRedundancyOperMode
          enum:
            notsupported: 1
            redundant: 2
            combined: 3
            nonRedundant: 4
            psRedundant: 5
            inPwrSrcRedundant: 6
            psRedundantSingleInput: 7




  # This table lists the power-related administrative status and operational status of the manageable components in the system.
  - MIB: CISCO-ENTITY-FRU-CONTROL-MIB
    table:
      name: cefcFRUPowerStatusTable
      OID: 1.3.6.1.4.1.9.9.117.1.1.2
    symbols:
      # Current supplied by the FRU (positive values) or current required to operate the FRU (negative values).
      - name: cefcFRUCurrent
        OID: 1.3.6.1.4.1.9.9.117.1.1.2.1.3
      # Operational FRU power state.
      - name: cefcFRUPowerOperStatus
        OID: 1.3.6.1.4.1.9.9.117.1.1.2.1.2
        enum:
          offEnvOther: 1
          on: 2
          offAdmin: 3
          offDenied: 4
          offEnvPower: 5
          offEnvTemp: 6
          offEnvFan: 7
          failed: 8
          onButFanFail: 9
          offCooling: 10
          offConnectorRating: 11
          onButInlinePowerFail: 12
        tag: fru_power_oper_status
    metric_tags:
      # Administratively desired FRU power state.
      - tag: fru_power_admin_status
        column:
          name: cefcFRUPowerAdminStatus
          OID: 1.3.6.1.4.1.9.9.117.1.1.2.1.1
          enum:
            on: 1
            off: 2
            inlineAuto: 3
            inlineOn: 4
            powerCycle: 5
      # A textual description of physical entity.
      - tag: entity_description
        column:
          name: entPhysicalDescr
          OID: 1.3.6.1.2.1.47.1.1.1.1.2
      # An indication of the general hardware type of the physical entity.
      - tag: entity_class
        column:
          name: entPhysicalClass
          OID: 1.3.6.1.2.1.47.1.1.1.1.5
          enum:
            other: 1
            unknown: 2
            chassis: 3
            backplane: 4
            container: 5
            powerSupply: 6
            fan: 7
            sensor: 8
            module: 9
            port: 10
            stack: 11
            cpu: 12
      # The textual name of the physical entity.
      - tag: entity_name
        column:
          name: entPhysicalName
          OID: 1.3.6.1.2.1.47.1.1.1.1.7
      # The vendor-specific serial number string for the physical entity.
      - tag: entity_serial
        column:
          name: entPhysicalSerialNum
          OID: 1.3.6.1.2.1.47.1.1.1.1.11
      # The vendor-specific model name identifier string associated with this physical component.
      - tag: entity_model
        column:
          name: entPhysicalModelName
          OID: 1.3.6.1.2.1.47.1.1.1.1.13