# file: cisco-oc-components-power-supply.yml
# SNMP: CISCO-ENVMON-MIB::ciscoEnvMonSupplyStatusTable
# OC: /components/component/power-supply/state
# Kentik-path: /components/power-supply
---

extends:
  - oc-components_entPhysicalTable.yml

metrics:

  - MIB: /components
    table:
      OID: .1.3.6.1.4.1.9.9.13.1.5    # CISCO-ENVMON-MIB::ciscoEnvMonSupplyStatusTable
      name: power-supply
      # oc-path: /components/component/state/temperature

    symbols:

      - tag: power-supply:state
        OID: .1.3.6.1.4.1.9.9.13.1.5.1.3
        name: ciscoEnvMonSupplyState
        enum:
          NORMAL: 1
          WARNING: 2
          MAJOR: 3
          CRITICAL: 4
          UNKNOWN: 5
          UNKNOWN: 6

    metric_tags:

      # this is needed for the old software which do not use the same index as ENTITY-MIB
      - tag: components:name
        column:
          OID: .1.3.6.1.4.1.9.9.13.1.5.1.2
          name: ciscoEnvMonSupplyStatusDescr

      - tag: components:name
        column:
          OID: .1.3.6.1.2.1.47.1.1.1.1.7
          name: entPhysicalName

      - tag: components:description
        column:
          OID: .1.3.6.1.2.1.47.1.1.1.1.2
          name: entPhysicalDescr


      # The current state of the testpoint being instrumented.
      # OC: OPENCONFIG_ALARM_SEVERITY - UNKNOWN, MINOR, WARNING, MAJOR, CRITICAL
      # 'state' does not exist in OC
      - tag: power-supply:state
        column:
          OID: .1.3.6.1.4.1.9.9.13.1.5.1.3
          name: ciscoEnvMonSupplyState
          enum:
            NORMAL: 1
            WARNING: 2
            MAJOR: 3
            CRITICAL: 4
            MISSING: 5
            UNKNOWN: 6
        # Represents the state of a device being monitored. Valid values are: 
        # normal(1): the environment is good, such as low temperature. 
        # warning(2): the environment is bad, such as temperature above normal operation range but not too high. 
        # critical(3): the environment is very bad, such as temperature much higher than normal operation limit. 
        # shutdown(4): the environment is the worst, the system should be shutdown immediately. 
        # notPresent(5): the environmental monitor is not present, such as temperature sensors do not exist. 
        # notFunctioning(6): the environmental monitor does not function properly, such as a temperature sensor generates a abnormal data like 1000 C.
