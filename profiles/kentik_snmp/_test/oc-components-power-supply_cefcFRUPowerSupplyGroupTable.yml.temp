# oc-components-power-supply_cefcFRUPowerSupplyGroupTable.yml
# SNMP: CISCO-ENTITY-FRU-CONTROL-MIB::cefcFRUPowerSupplyGroupTable
#   - ENTITY-MIB::entPhysicalTable
# OC: /components/component/power-supply/state
# Kentik-path: /components/power-supply
#
# Profile intents to collect metadata and metrics about device power supplies from CISCO-ENTITY-FRU-CONTROL-MIB::cefcFRUPowerSupplyGroupTable
# This MIBs is using the same indexes from ENTITY-MIB, and adds metics only to the components which are power-supplies
# Trying to normalize metrics to OC models as much as possible


---

extends:
  - oc-components_entPhysicalTable.yml

metrics:

  - MIB: /components
    table:
      OID: .1.3.6.1.4.1.9.9.117.1.1.1.1    # CISCO-ENTITY-FRU-CONTROL-MIB::cefcFRUPowerSupplyGroupTable
      name: power-supply

    symbols:

      - tag: power-supply:output-current
        OID: .1.3.6.1.4.1.9.9.117.1.1.1.1.3
        name: cefcTotalAvailableCurrent

      - tag: power-supply:input-current
        OID: .1.3.6.1.4.1.9.9.117.1.1.1.1.4
        name: cefcTotalDrawnCurrent

      # - tag: power-supply/redundancy-mode
      #   OID: 1.3.6.1.4.1.9.9.117.1.1.1.1.5
      #   name: cefcPowerRedundancyOperMode
      #   enum:
      #     notsupported: 1
      #     redundant: 2
      #     combined: 3
      #     nonRedundant: 4
      #     psRedundant: 5
      #     inPwrSrcRedundant: 6
      #     psRedundantSingleInput: 7

    metric_tags:

      - tag: components:name
        column:
          OID: .1.3.6.1.2.1.47.1.1.1.1.2
          name: entPhysicalDescr

      - tag: components:description
        column:
          OID: .1.3.6.1.2.1.47.1.1.1.1.7
          name: entPhysicalName
          
      - tag: components:type
        column:
          OID: .1.3.6.1.2.1.47.1.1.1.1.5
          name: entPhysicalClass
          enum:
            OTHER: 1
            UNKNOWN: 2
            CHASSIS: 3
            BACKPLANE: 4
            CONTAINER: 5
            POWER_SUPPLY: 6
            FAN: 7
            SENSOR: 8
            MODULE: 9
            PORT: 10
            STACK: 11
            CPU: 12

      - tag: power-supply:units
        column:
          OID: .1.3.6.1.4.1.9.9.117.1.1.1.1.2
          name: cefcPowerUnits

      - tag: power-supply:redundancy-mode
        column:
          OID: .1.3.6.1.4.1.9.9.117.1.1.1.1.5
          name: cefcPowerRedundancyOperMode
          enum:
            notsupported: 1
            redundant: 2
            combined: 3
            nonRedundant: 4
            psRedundant: 5
            inPwrSrcRedundant: 6
            psRedundantSingleInput: 7
